var tagDataMoney = {
	"1": [{
		name: "任志强批央视愚蠢",
		url: "http://tag.163.com/money/104/104255/1.html",
		doctitle: "央视称房企欠税3.8万亿 任志强批愚蠢无知"
	}, {
		name: "中石油质疑中石化",
		url: "http://tag.163.com/money/104/104266/1.html",
		doctitle: "中石油高层质疑中石化:爆燃前7小时内为何不疏散"
	}, {
		name: "延迟退休无实际意义",
		url: "http://tag.163.com/money/104/104149/1.html",
		doctitle: "社科院专家：延迟退休并无实际意义 公平是关键"
	}, {
		name: "伊朗核问题达成协议",
		url: "http://tag.163.com/money/104/104267/1.html",
		doctitle: "伊核问题达成阶段协议 伊朗石油生意终获解冻"
	}, {
		name: "央企负责人薪酬72万",
		url: "http://tag.163.com/money/104/104072/1.html",
		doctitle: "国资委官员：2011年央企负责人平均薪酬为72万元"
	}, {
		name: "人民币汇改",
		url: "http://tag.163.com/money/103/103958/1.html",
		doctitle: "人民币汇改8年升值超35% 内贬外升引不满"
	}, {
		name: "6800万套空置房",
		url: "http://tag.163.com/money/103/103930/1.html",
		doctitle: "学者称中国楼市生产过剩 有6800万套空置房"
	}, {
		name: "青岛油管爆燃事故",
		url: "http://tag.163.com/money/104/104272/1.html",
		doctitle: "习近平抵达青岛看望慰问爆燃事故伤员"
	}, {
		name: "海外金融资产需申报",
		url: "http://tag.163.com/money/104/104076/1.html",
		doctitle: "个人海外金融资产需申报 对民众影响几何？"
	}, {
		name: "17个城市暂停房贷",
		url: "http://tag.163.com/money/104/104370/1.html",
		doctitle: "17城市暂停房贷 专家称银行开始看空房地产后市"
	}],
	"2": [{
		name: "民营银行办法报国务院",
		url: "http://tag.163.com/money/104/104268/1.html"
	}, {
		name: "比特币交易平台",
		url: "http://tag.163.com/money/104/104035/1.html"
	}, {
		name: "40城住房信息联网",
		url: "http://tag.163.com/money/104/104103/1.html"
	}, {
		name: "上海国资改革",
		url: "http://tag.163.com/money/104/104271/1.html"
	}, {
		name: "粤港澳自贸区",
		url: "http://tag.163.com/money/104/104109/1.html"
	}, {
		name: "乳业巨头涨价",
		url: "http://tag.163.com/money/104/104280/1.html"
	}, {
		name: "光大证券再收罚单",
		url: "http://tag.163.com/money/104/104259/1.html"
	}, {
		name: "中储粮被削权",
		url: "http://tag.163.com/money/103/103835/1.html"
	}, {
		name: "温州民间借贷合法",
		url: "http://tag.163.com/money/104/104273/1.html"
	}, {
		name: "发改委反垄断",
		url: "http://tag.163.com/money/104/104276/1.html"
	}, {
		name: "阿里承认封杀微信",
		url: "http://tag.163.com/money/104/104264/1.html"
	}, {
		name: "国泰君安卷入诈骗案",
		url: "http://tag.163.com/money/103/103933/1.html"
	}, {
		name: "自贸区金融方案细则",
		url: "http://tag.163.com/money/104/104260/1.html"
	}, {
		name: "65城市房价上涨",
		url: "http://tag.163.com/money/103/103380/1.html"
	}],
	"3": [{
		name: "中汉集团陷债务危机",
		url: "http://tag.163.com/money/103/103929/1.html"
	}, {
		name: "不动产登记贪官",
		url: "http://tag.163.com/money/104/104251/1.html"
	}, {
		name: "华润锦华重组被否",
		url: "http://tag.163.com/money/103/103943/1.html"
	}, {
		name: "10月CPI涨幅",
		url: "http://tag.163.com/money/104/104157/1.html"
	}, {
		name: "武汉楼市限购升级",
		url: "http://tag.163.com/money/104/104212/1.html"
	}, {
		name: "京沪高铁多花2.3亿",
		url: "http://tag.163.com/money/103/103367/1.html"
	}, {
		name: "大病提取公积金",
		url: "http://tag.163.com/money/103/103063/1.html"
	}, {
		name: "上海家化违规内幕",
		url: "http://tag.163.com/money/103/103948/1.html"
	}, {
		name: "徐敏杰受贿",
		url: "http://tag.163.com/money/104/104049/1.html"
	}, {
		name: "恒大地王",
		url: "http://tag.163.com/money/103/103949/1.html"
	}, {
		name: "北京至南宁贯通高铁",
		url: "http://tag.163.com/money/103/103547/1.html"
	}, {
		name: "圣元收购育婴博士",
		url: "http://tag.163.com/money/103/103940/1.html"
	}, {
		name: "神开股份信披违规被查",
		url: "http://tag.163.com/money/103/103945/1.html"
	}, {
		name: "法国削减农业补贴",
		url: "http://tag.163.com/money/103/103932/1.html"
	}],
	"4": [{
		name: "央企一把手拟选聘",
		url: "http://tag.163.com/money/103/103483/1.html"
	}, {
		name: "南水北调西线难动工",
		url: "http://tag.163.com/money/103/103494/1.html"
	}, {
		name: "四领域蕴藏投资潜力",
		url: "http://tag.163.com/money/103/103368/1.html"
	}, {
		name: "收入跑不赢GDP",
		url: "http://tag.163.com/money/102/102816/1.html"
	}, {
		name: "昌九生化爆仓惨案",
		url: "http://tag.163.com/money/102/102917/1.html"
	}, {
		name: "航班油量不够抛客",
		url: "http://tag.163.com/money/103/103292/1.html"
	}, {
		name: "洪都航空",
		url: "http://tag.163.com/money/103/103979/1.html"
	}, {
		name: "津滨发展",
		url: "http://tag.163.com/money/99/99648/1.html"
	}, {
		name: "自住型商品房",
		url: "http://tag.163.com/money/99/99580/1.html"
	}, {
		name: "中国煤炭银行",
		url: "http://tag.163.com/money/103/103786/1.html"
	}, {
		name: "威海广泰涨停",
		url: "http://tag.163.com/money/103/103910/1.html"
	}, {
		name: "房地产税立法",
		url: "http://tag.163.com/money/103/103770/1.html"
	}]
};
Array.prototype.randomIndex = function(){
	var length = this.length;
	return ~~(length*Math.random());
};
Array.prototype.del = function(n){
	if(n<0){
		return this;
	}else{
		return this.slice( 0 , n ).concat( this.slice( n + 1 , this.length ) );
	}
};
var TagShow = function(init){
	this.container = init.container;
	this.unitList = [];
	this.first = false;
	this.init();
};

TagShow.prototype = {
	init : function(){
		var _this = this,
			createTemplate = _this.createTemplate,
			setCSS = _this.setCSS,
			insert = _this.insert,
			unitList = _this.unitList,
			elem,
			i , sum ,
			rule = _this.divideRule(_this.container.offsetWidth , _this.container.offsetHeight);
		for( i = 0 , sum = rule.length ; i < sum ; ++i ){
			elem = createTemplate({
				url : '#',
				name : ''
			});
			setCSS(elem,rule[i]);
			unitList.push(elem);
		}

		insert.call(this);
		return this;
	},createTemplate : function( data ){
		var _this = this,
			template = [],
			elem = document.createElement("div");
		template.push('<a href="'+ data.url +'"><span class="inner">'+data.name);
		if( 'doctitle' in data ){
			template.push('<span class="doc-title">'+ data.doctitle +'</span>');
		}
		template.push('</span><i></i></a>');
		elem.innerHTML = template.join('');
		elem.className = 'tag';
		return elem;
	},setCSS : function( elem , css ){
		var key;


		for( key in css ){
			elem.style[key] = css[key]+'px';
		}

		return this;
	},insert : function(){
		var _this = this,
			container = _this.container,
			unitList = _this.unitList,
			i , sum;
		for( i = 0 , sum = unitList.length ; i < sum ; ++i ){
			container.appendChild( unitList[i] );
		}
		return this;
	},divideRule : function( width , height ){
		var _this = this,
			rule = [],
			config = [
				{
					direction : 'both',
					proportion : 50,
					range : 20
				},{
					direction : 'auto',
					proportion : 30,
					range : 5
				},{
					direction : 'auto',
					proportion : 30,
					range : 5
				},{
					direction : 'auto',
					proportion : 50,
					range : 5
				}
			],
			left = 0,
			top = 0,
			multipleDivide = _this.multipleDivide;


		rule = rule.concat(multipleDivide.call(_this,[{
			top : top,
			left : left,
			width : width,
			height : height
		}] , config ));

		return rule;
	},divide : function( left , top , width , height , rule ){
		var _this = this,
			direction = rule.direction || 'auto',
			proportion = rule.proportion || 50,
			range = rule.range || 5,

			i , sum ,

			part = [],
			random = Math.random,
			_left = left,
			_top = top,
			_width,
			_height;
		if( width < 100 || height < 100 ){
			return [{
				left : left,
				top : top,
				width : width,
				height : height,
			}];
		}

		if( direction == 'auto' ){
			if( height > width ){
				direction = 'vertical';
			}else{
				direction = 'align';
			}
		}

		switch( direction ){
			case 'vertical' :
				_height = _this.divideNumber( height , proportion , range );
				for( i = 0 , sum = _height.length ; i < sum ; ++i ){
					if( i == 0 ){
						_top = 0;
					}else{
						_top += _height[i-1];
					}
					part.push({
						top : top + _top,
						left : _left,
						width : width,
						height : _height[i]
					});
				}
				break;
			case 'align' :
				_width = _this.divideNumber( width , proportion , range );
				for( i = 0 , sum = _width.length ; i < sum ; ++i ){
					if( i == 0 ){
						_left = 0;
					}else{
						_left += _width[i-1];
					}
					part.push({
						top : _top,
						left : left + _left,
						width : _width[i],
						height : height
					});
				}
				break;
			case 'both' :
				proportion = proportion > 33 ? proportion : 50;
				_width = _this.divideNumber( width , proportion , range );
				_height = _this.divideNumber( height , proportion , range );
				
				part.push({top : _top,left : _left,width : _width[0],height : _height[0]});
				part.push({top : _top,left : _left + _width[0],width:_width[1],height : _height[0]});
				part.push({top : _top + _height[0],left : _left,width : _width[0],height : _height[1]});
				part.push({top : _top + _height[0],left : _left + _width[0],width :_width[1],height:_height[1]});
				break;
		}

		return part;
	},divideNumber : function( number , proportion , range ){
		proportion = proportion || 50;
		range = range || 0;

		var i, 
			sum = ~~( 100 / proportion ),
			part = [];

		if( sum == 1 ){
			sum = 2;
		}

		for( i = 0 , sum =  sum - 1 ; i < sum ; ++i ){
			proportion = proportion + (~~(Math.random()*range*2)-range);
			part.push( number * proportion / 100 );
			number -= number * proportion / 100
		}
		part.push(number);
		return part;
	},multipleDivide : function( arr , rule ){

		var _this = this,
			divide = _this.divide,
			tempResult = [],
			result = [],
			_rule = rule.slice(0),
			i , sum , index,
			currentRule = _rule.shift();

		for( i = 0 , sum = arr.length ; i < sum ; ++i ){
			tempResult = divide.call(_this, arr[i].left , arr[i].top , arr[i].width , arr[i].height , currentRule );
			if( _rule.length !== 0 ){
				if( _this.first ){
					index = tempResult.randomIndex();
					result.push(tempResult[index]);
					tempResult = tempResult.del(index);
					_this.first = true;
				}
				

				result = result.concat(_this.multipleDivide( tempResult , _rule ));
			}else{
				result = result.concat(tempResult);
			}
		}



		return result;
	}
};
var a = new TagShow({
	container : document.getElementById('container')
});